{% extends "sentry/teams/base.html" %}

{% load crispy_forms_tags %}
{% load i18n %}
{% load sentry_helpers %}
{% load sentry_plugins %}

{% block title %}{{ team.name }} {% trans "Settings" %} | {{ block.super }}{% endblock %}

{% block main %}
    <style>
    .nav > li {
        position: relative !important;
    }
    .nav > li > a.nav-add {
        width: 30px;
        text-align:center;
        font-size: 24px;
        font-weight: bold;
        padding: 0;
        position:absolute;
        right:0;
        bottom: 0;
        top:0;
        display: inline-block;
        line-height: 32px;
        border-left: 1px solid #fff;
        border-radius: 0 8px 8px 0;
    }
    </style>

    <div class="page-header">
        <h3>{% trans "Team Settings" %}</h3>
    </div>
    <div class="row">
        <div class="col-sm-3">
            <ul class="nav nav-pills nav-stacked">
                <li{% if SUBSECTION == 'settings' %} class="active"{% endif %}>
                    <a href="{% url 'sentry-manage-team' team.slug %}">{% trans "Settings" %}</a>
                </li>
                <li{% if SUBSECTION == 'projects' %} class="active"{% endif %}>
                    <a href="{% url 'sentry-manage-team-projects' team.slug %}">{% trans "Projects" %}</a>
                    <a href="{% url 'sentry-new-project' team.slug %}" class="nav-add">
                        <i class="glyphicon glyphicon-plus"></i>
                    </a>
                </li>
                <li{% if SUBSECTION == 'members' %} class="active"{% endif %}>
                    <a href="{% url 'sentry-manage-team-members' team.slug %}">{% trans "Members" %}</a>
                </li>
                <li{% if SUBSECTION == 'groups' %} class="active"{% endif %}>
                    <a href="{% url 'sentry-manage-access-groups' team.slug %}">{% trans "Access Groups" %}</a>
                </li>

                <li class="divider"></li>
                <li ng-if="selectedTeam.permission.admin"
                    ui-sref-active="active"><a ui-sref="manage_team.ownership()">Transfer Ownership</a></li>
                <li ng-if="selectedTeam.permission.admin"
                    ui-sref-active="active"><a ui-sref="manage_team.delete()">Delete Team</a></li>
                </li>
            </ul>
        </div>
        <div class="col-sm-9">
            {% block inner %}
                <form class="form-stacked" action="" method="post">
                    {% csrf_token %}

                    {% if form.errors %}
                        <div class="alert alert-error">{% trans "Please correct the errors below." %}</div>
                    {% endif %}

                    {{ form|as_crispy_errors }}

                    <fieldset>
                        {% for field in form %}
                            {% if field.name != 'owner' %}
                                {{ field|as_crispy_field }}
                            {% endif %}
                        {% endfor %}
                    </fieldset>

                    <fieldset class="form-actions">
                        <button type="submit" class="btn btn-primary">{% trans "Save Changes" %}</button>
                    </fieldset>
                </form>
            {% endblock %}
        </div>
    </div>

    <script type="text/javascript">
        require(['config', 'app/init'], function(_, app){
            new app.TeamDetailsPage();
        });
    </script>
{% endblock %}
