{% extends "sentry/layout.html" %}

{% load i18n %}

{% block title %}{% trans "Dashboard" %} | {{ block.super }}{% endblock %}

{% block controller %}TeamDashboardCtrl{% endblock %}

{% block scripts %}
  {{ block.super }}
  <script src="{% url 'sentry-media' 'sentry' 'vendor/chartjs/Chart.min.js' %}" type="text/javascript"></script>

  <script type="text/javascript">
    $(function() {

    // Hero chart

    var hero_data = {
      labels: ["January", "February", "March", "April", "May", "June", "July"],
      datasets: [
          {
              label: "Events",
              fillColor: "rgba(220,220,220,0.2)",
              strokeColor: "rgba(220,220,220,1)",
              pointColor: "rgba(220,220,220,1)",
              pointStrokeColor: "#32383F",
              pointHighlightFill: "#32383F",
              pointHighlightStroke: "#fff",
              data: [65, 59, 80, 81, 56, 55, 40]
          },
          {
              label: "Resolved",
              fillColor: "rgba(151,187,205,0.2)",
              strokeColor: "rgba(151,187,205,1)",
              pointColor: "rgba(151,187,205,1)",
              pointStrokeColor: "#32383F",
              pointHighlightFill: "#32383F",
              pointHighlightStroke: "#fff",
              data: [28, 48, 40, 19, 86, 27, 90]
          }
        ]
      };

      var ctx1 = document.getElementById("hero-chart").getContext("2d");
      var myLineChart = new Chart(ctx1).Line(hero_data, {
        bezierCurve: false,
        responsive: true,
        maintainAspectRatio: false,
        scaleGridLineColor: "rgba(255, 255, 255, .05)",
        scaleFontColor: "rgba(255, 255, 255, .6)",
      });

      // Pie charts

      var doughnut_1_data = [
          {
              value: 300,
              color:"#F7464A",
              highlight: "#FF5A5E",
              label: "Red"
          },
          {
              value: 50,
              color: "#46BFBD",
              highlight: "#5AD3D1",
              label: "Green"
          },
          {
              value: 100,
              color: "#FDB45C",
              highlight: "#FFC870",
              label: "Yellow"
          }
      ]

      var ctx2 = document.getElementById("doughnut_1").getContext("2d");
      var doughnutOne = new Chart(ctx2).Doughnut(doughnut_1_data, {
        responsive: true
      });

      var doughnut_2_data = [
          {
              value: 300,
              color:"#F7464A",
              highlight: "#FF5A5E",
              label: "Red"
          },
          {
              value: 50,
              color: "#46BFBD",
              highlight: "#5AD3D1",
              label: "Green"
          },
          {
              value: 100,
              color: "#FDB45C",
              highlight: "#FFC870",
              label: "Yellow"
          }
      ]

      var ctx3 = document.getElementById("doughnut_2").getContext("2d");
      var doughnutTwo = new Chart(ctx3).Doughnut(doughnut_2_data, {
        responsive: true
      });

      var doughnut_3_data = [
          {
              value: 300,
              color:"#F7464A",
              highlight: "#FF5A5E",
              label: "Red"
          },
          {
              value: 50,
              color: "#46BFBD",
              highlight: "#5AD3D1",
              label: "Green"
          },
          {
              value: 100,
              color: "#FDB45C",
              highlight: "#FFC870",
              label: "Yellow"
          }
      ]

      var ctx4 = document.getElementById("doughnut_3").getContext("2d");
      var doughnutThree = new Chart(ctx4).Doughnut(doughnut_3_data, {
        responsive: true
      });

    });
  </script>
{% endblock %}

{% block page_header_block %}
<div class="hero-chart-container">
  <canvas id="hero-chart"></canvas>
</div>

{% endblock %}

{% block content %}
    <div class="main">
        {% block alerts %}
            {% include "sentry/partial/alerts.html" %}
        {% endblock %}
        {% block main %}
            <div class="dashboard">

              <div class="row">
                <div class="col-md-4">
                  <div class="box">
                    <div class="box-header">Something lol</div>
                    <div class="box-content" style="padding:20px 0">
                      <canvas id="doughnut_1"></canvas>
                    </div>
                  </div>
                </div>
                <div class="col-md-4">
                  <div class="box">
                    <div class="box-header">Something lol</div>
                    <div class="box-content" style="padding:20px 0">
                      <canvas id="doughnut_2"></canvas>
                    </div>
                  </div>
                </div>
                <div class="col-md-4">
                  <div class="box">
                    <div class="box-header">Something lol</div>
                    <div class="box-content" style="padding:20px 0">
                      <canvas id="doughnut_3"></canvas>
                    </div>
                  </div>
                </div>
              </div>

                {% if project_list %}
                    <div class="row">
                        <div class="col-md-6">
                            <div class="box">
                                <div class="box-header clearfix">
                                    <h3 class="pull-left">{% trans "Trends" %}</h3>
                                    <ul class="nav nav-pills nav-small pull-right">
                                        <li ng-class="trendingGroupList.selected == '15' ? 'active': ''">
                                            <a href="#" ng-click="loadTrendingGroups('15')">{% trans "15 minutes" %}</a></li>
                                        <li ng-class="trendingGroupList.selected == '60' ? 'active': ''">
                                            <a href="#" ng-click="loadTrendingGroups('60')">{% trans "60 minutes" %}</a></li>
                                        <li ng-class="trendingGroupList.selected == '1440' ? 'active': ''">
                                            <a href="#" ng-click="loadTrendingGroups('1440')">{% trans "24 hours" %}</a></li>
                                    </ul>
                                </div>
                                <div class="box-content">
                                    <div class="tab-pane active">
                                        <p ng-show="trendingGroupList.state == 'loading'">{% trans "Loading ..." %}</p>
                                        <p ng-show="trendingGroupList.state == 'error'">{% trans "There was an error fetching data from the server." %}</p>
                                        <ul ng-show="trendingGroupList.state == 'results'" class="dashboard-events">
                                            <li ng-repeat="group in trendingGroupList">
                                                <div class="dashboard-count">
                                                  <span count="group.count"></span>
                                                </div>
                                                <div class="dashboard-details">
                                                  <h3><a href="<% group.permalink %>"><% group.title %></a></h3>
                                                  <p class="message"><% group.culprit %></p>
                                                  <p class="time"><span>First:</span> <time time-since="group.firstSeen"></time>. <span>Last:</span> <time time-since="group.lastSeen"></time>.</p>
                                                </div>
                                            </li>
                                        </ul>
                                        <p class="empty" ng-show="trendingGroupList.state == 'no-results'" class="list-empty">{% trans "There are no events within the selected time window." %}</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="box">
                                <div class="box-header clearfix">
                                    <h3 class="pull-left">{% trans "New Events" %}</h3>
                                    <ul class="nav nav-pills nav-small pull-right">
                                        <li ng-class="newGroupList.selected == '15' ? 'active': ''">
                                            <a href="#" ng-click="loadNewGroups('15')">{% trans "15 minutes" %}</a></li>
                                        <li ng-class="newGroupList.selected == '60' ? 'active': ''">
                                            <a href="#" ng-click="loadNewGroups('60')">{% trans "60 minutes" %}</a></li>
                                        <li ng-class="newGroupList.selected == '1440' ? 'active': ''">
                                            <a href="#" ng-click="loadNewGroups('1440')">{% trans "24 hours" %}</a></li>
                                    </ul>
                                </div>
                                <div class="box-content">
                                    <div class="tab-pane active">
                                        <p ng-show="newGroupList.state == 'loading'">{% trans "Loading ..." %}</p>
                                        <p ng-show="newGroupList.state == 'error'">{% trans "There was an error fetching data from the server." %}</p>
                                        <ul ng-show="newGroupList.state == 'results'" class="dashboard-events">
                                            <li ng-repeat="group in newGroupList">
                                                <div class="dashboard-count">
                                                  <span count="group.count"></span>
                                                </div>
                                                <div class="dashboard-details">
                                                  <h3><a href="<% group.permalink %>"><% group.title %></a></h3>
                                                  <p class="message"><% group.culprit %></p>
                                                  <p class="time"><span>First:</span> <time time-since="group.firstSeen"></time>. <span>Last:</span> <time time-since="group.lastSeen"></time>.</p>
                                                </div>
                                            </li>
                                        </ul>
                                        <p class="empty" ng-show="newGroupList.state == 'no-results'">{% trans "There are no events within the selected time window." %}</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                {% else %}
                    {% url 'sentry-new-project' team.slug as link %}
                    <div class="alert alert-info">{% blocktrans %}You do not have access to any projects. Would you like to <a href="{{ link }}">create a new project</a>?{% endblocktrans %}</div>
                {% endif %}
            </div>
        {% endblock %}
    </div>
{% endblock %}
